<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Converge MVP Test - Gecorrigeerd</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        #status-area {
            margin-bottom: 20px;
            font-size: 1.2em;
            color: #00ff88;
        }
        #score-area {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.5em;
        }
        #game-container {
            position: relative;
            width: 500px;
            height: 500px;
            border: 1px solid #333;
            background-color: #111;
        }
        .dot {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.1s, transform 0.1s; /* Voor visuele feedback */
            z-index: 10;
        }
        #dot1 {
            background-color: #00ff88;
        }
        .footprint {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #333;
            opacity: 0.5;
            z-index: 5;
        }
    </style>
</head>
<body>

<div id="score-area">Cyclus Voltooid: <span id="score-value">0</span></div>
<div id="status-area">Wacht op beweging...</div>
<div id="game-container">
    <div id="dot1" class="dot"></div>
</div>

<script>
    const container = document.getElementById('game-container');
    const dot1 = document.getElementById('dot1');
    const scoreValue = document.getElementById('score-value');
    const statusArea = document.getElementById('status-area');
    
    const gridSize = 10; 
    const unitSize = container.offsetWidth / gridSize;
    
    let currentPos1 = { x: 5, y: 5 }; // Start (5, 5)
    
    // Patroon Definitie (10 stappen Pendelaar)
    const pattern1 = [
        { dx: 1, dy: 0 }, { dx: 0, dy: 1 },
        { dx: -1, dy: 0 }, { dx: 0, dy: 1 },
        { dx: 1, dy: 0 }, { dx: 0, dy: 1 },
        { dx: -1, dy: 0 }, { dx: 0, dy: 1 },
        { dx: 1, dy: 0 }, { dx: 0, dy: 1 }
    ];
    let stepCount1 = 0;
    let isMoving1 = true;
    let intervalId1;
    let score = 0;

    function updateStatus(message, color = '#00ff88') {
        statusArea.textContent = message;
        statusArea.style.color = color;
    }

    // Functie om de visuele positie van de punt bij te werken
    function updateDotPosition(dotElement, gridX, gridY) {
        // CoÃ¶rdinaten omrekenen naar pixels (center van de unit)
        const left = (gridX * unitSize) - (dotElement.offsetWidth / 2);
        const top = (gridY * unitSize) - (dotElement.offsetHeight / 2);
        dotElement.style.left = `${left}px`;
        dotElement.style.top = `${top}px`;
    }

    // Functie om een voetafdruk te plaatsen
    function placeFootprint(x, y) {
        const fp = document.createElement('div');
        fp.className = 'footprint';
        container.appendChild(fp);
        const left = (x * unitSize) - (fp.offsetWidth / 2);
        const top = (y * unitSize) - (fp.offsetHeight / 2);
        fp.style.left = `${left}px`;
        fp.style.top = `${top}px`;
    }

    // De bewegingslus voor Punt 1
    function moveDot1() {
        if (!isMoving1) return;

        // Bepaal de volgende stap
        const step = pattern1[stepCount1 % pattern1.length];
        
        let newX = currentPos1.x + step.dx;
        let newY = currentPos1.y + step.dy;

        // Controleer op grenzen (blijf binnen 1 en 10)
        newX = Math.max(1, Math.min(gridSize, newX));
        newY = Math.max(1, Math.min(gridSize, newY));

        currentPos1 = { x: newX, y: newY };
        updateDotPosition(dot1, currentPos1.x, currentPos1.y);

        stepCount1++;
        updateStatus(`Punt 1 beweegt... Stap: ${stepCount1} van ${pattern1.length}`);

        // Stopt na 10 stappen als er niet geklikt is
        if (stepCount1 >= pattern1.length) {
            clearInterval(intervalId1);
            isMoving1 = false;
            dot1.style.backgroundColor = '#ff0000'; // Rood: Mislukt!
            updateStatus("MISLUKT: Tijd is om! Probeer opnieuw te starten.", '#ff0000');
        }
    }

    // De Klik Handler
    dot1.onclick = function() {
        // De klik is nu altijd geldig als de punt beweegt (isMoving1)
        if (isMoving1) {
            // Check of de klik niet op de allerlaatste stap kwam (te laat)
            if (stepCount1 < pattern1.length) {
                // Succesvolle klik!
                
                // 1. Plaats de voetafdruk
                placeFootprint(currentPos1.x, currentPos1.y);

                // 2. Reset de bewegingstimer en teller
                clearInterval(intervalId1);
                stepCount1 = 0;
                intervalId1 = setInterval(moveDot1, 500); // Beweeg elke 500ms
                updateDotPosition(dot1, currentPos1.x, currentPos1.y); // Reset naar (5,5)

                // 3. Score/Status update
                score++;
                scoreValue.textContent = score;
                updateStatus(`SUCCES: Cyclus voltooid! (${score}x)`);

                // **LOGICA VOOR PUNT 2 INTRODUCTIE**
                if (score === 3) { // Nu op 3 voor snellere test
                    updateStatus("Introductie Punt 2! Maak je klaar.", '#ffaa00');
                    initializeDot2(); // Roep de nieuwe functie aan
                }
            } else {
                 updateStatus("Klik te laat! De cyclus was al voltooid.", '#ffaa00');
            }
        } else {
             // Als de beweging gestopt is door falen, reset het spel.
             currentPos1 = { x: 5, y: 5 };
             isMoving1 = true;
             stepCount1 = 0;
             dot1.style.backgroundColor = '#00ff88';
             updateDotPosition(dot1, currentPos1.x, currentPos1.y);
             intervalId1 = setInterval(moveDot1, 500);
             updateStatus("Punt 1 gereset. Begin nu met klikken!");
        }
    };

    // Initialisatie
    updateDotPosition(dot1, currentPos1.x, currentPos1.y);
    intervalId1 = setInterval(moveDot1, 500);
</script>

</body>
</html>
